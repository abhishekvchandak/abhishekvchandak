<html>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&callback=initialize"></script>
<script src='https://www.google.com/recaptcha/api.js'></script>
<script src='https://www.google.com/recaptcha/api.js?hl=en'></script>
<script type="text/javascript">
	var location1;
	var location2;
	
	var address1;
	var address2;

	var latlng;
	var geocoder;
	var map;
	
	var distance;


	// finds the coordinates for the two locations and calls the showMap() function
	function initialize(clicked_id)
	{
		
		geocoder = new google.maps.Geocoder(); // creating a new geocode object
		
		
		
		// getting the two address values
		address1 = document.getElementById("address1").value;
		address2 = document.getElementById("address2").value;
		
		address1_check = address1.toLowerCase();
		address2_check = address2.toLowerCase();
	
	if((address1!="" && address2!=""))
	{
		if((address1_check.includes("bangalore") || address1_check.includes("bengaluru")) && (address2_check.includes("bangalore") || address2_check.includes("bengaluru")))
		{
			// finding out the coordinates
			
			document.getElementById('address12').style.display = "block";
			document.getElementById('map-container1').style.display = "block";
			
			if (geocoder) 
			{
				geocoder.geocode( { 'address': address1}, function(results, status) 
				{
					if (status == google.maps.GeocoderStatus.OK) 
					{
						//location of first address (latitude + longitude)
						location1 = results[0].geometry.location;
					} else 
					{
						alert("Geocode was not successful for the following reason: " + status);
					}
				});
				geocoder.geocode( { 'address': address2}, function(results, status) 
				{
					if (status == google.maps.GeocoderStatus.OK) 
					{
						//location of second address (latitude + longitude)
						location2 = results[0].geometry.location;
						// calling the showMap() function to create and show the map 
						showMap(clicked_id);
					} else 
					{
						alert("Geocode was not successful for the following reason: " + status);
					}
				});
			}
		}

		else
		{
			document.getElementById("deliverycharge").innerHTML = "<br><div class=\"alert alert-danger\">Goods will be delivered only in Bangalore.</div>";
			document.getElementById('address12').style.display = "none";
			document.getElementById('map-container1').style.display = "none";
		}
	}
	}
		
	// creates and shows the map
	function showMap(clicked_id)
	{
		// center of the map (compute the mean value between the two locations)
		latlng = new google.maps.LatLng((location1.lat()+location2.lat())/2,(location1.lng()+location2.lng())/2);

		var weight;
        weight = document.getElementById("weight").value;

		// set map options
			// set zoom level
			// set center
			// map type
		var mapOptions = 
		{
			types: ['(Bangalore)'],
			componentRestrictions: {country: "in"},
			zoom: 1,
			center: latlng,
			mapTypeId: google.maps.MapTypeId.DRIVING
		};
		
		// create a new map object
			// set the div id where it will be shown
			// set the map options
			map = new google.maps.Map(document.getElementById("map-container1"), mapOptions);
		
		// show route between the points
		directionsService = new google.maps.DirectionsService();
		directionsDisplay = new google.maps.DirectionsRenderer();
		directionsDisplay.setMap(map);
		var request = {
			origin:location1, 
			destination:location2,
			travelMode: google.maps.DirectionsTravelMode.DRIVING
		};
		directionsService.route(request, function(response, status) 
		{
			if (status == google.maps.DirectionsStatus.OK) 
			{
				directionsDisplay.setDirections(response);

              if (weight < 5) {
              weight_ceil = 5;
              } else {
              weight_ceil = weight;
              }

               distance_string = response.routes[0].legs[0].distance.text;
               str_length = distance_string.length;
               left_size = str_length - 5;
               distance_substring = distance_string.substring(0,left_size);
               distance_num = parseInt(distance_substring);

               if (distance_num < 5) {
              distance_ceil = 5;
              } else if (distance_num < 10) {
              distance_ceil = 10;
              } else if (distance_num < 15) {
              distance_ceil = 15;
             } else if (distance_num < 20) {
              distance_ceil = 20;
              } else if (distance_num < 25) {
              distance_ceil = 25;
             } else if (distance_num < 30) {
               distance_ceil = 30;    
            } else {
            distance_ceil = 0;
             }

            if(clicked_id==="booknow")
			{
				delivery_charge1= 1.5*weight_ceil*distance_ceil;
				delivery_charge2 = 2.5*weight_ceil*distance_ceil;
				
				if((delivery_charge1%10)>0){
				delivery_charge1 = delivery_charge1 + (10 - (delivery_charge1%10));
				}
				
				if((delivery_charge2%10)>0){
				delivery_charge2 = delivery_charge2 + (10 - (delivery_charge2%10));
				}
				
				document.getElementById("deliverycharge").innerHTML = "<br><div class=\"alert alert-info\"><br>Signature: <font color=\"red\">Rs. "+delivery_charge1+"</font>.&nbsp;&nbsp;&nbsp;&nbsp;Express: <font color=\"red\">Rs. "+delivery_charge2+"</font>.<br>This is an estimated delivery charge. The actual charges may vary based on any special delivery requirements specified. We will confirm the final amount before pickup.<br><font color=\"red\">Signature deliveries are accepted only till 2 PM.</font><br><font color=\"green\">Signature</font>: The package will be delivered before 8pm on the same business day. Any acknowledgments, cash,etc will be delivered back the next day.<br><font color=\"green\">Express</font>: The package will delivered within 2 hours of pickup. Any acknowledgments, cash, etc will be delivered immediately after the delivery.<br></div>";
			}
			
			if(distance_ceil==0)
			{
				if(clicked_id==="booknow")
			{
				document.getElementById('address12').style.display = "none";
				document.getElementById('map-container1').style.display = "none";
			}
			}
			}
		});
		
	}

// This example displays an address form, using the autocomplete feature
// of the Google Places API to help users fill in the information.

/*var placeSearch, autocomplete;
var componentForm = {
  street_number: 'short_name',
  route: 'long_name',
  locality: 'long_name',
  administrative_area_level_1: 'short_name',
  country: 'long_name',
  postal_code: 'short_name'
};*/

function initAutocomplete() {
  // Create the autocomplete object, restricting the search to geographical
  // location types.
  var options = {
  componentRestrictions: {country: "in"}
 };
  
	autocomplete1 = new google.maps.places.Autocomplete(
      /** @type {!HTMLInputElement} */(document.getElementById('address1')),
      options);

	autocomplete2 = new google.maps.places.Autocomplete(
      /** @type {!HTMLInputElement} */(document.getElementById('address2')),
      {types: ['geocode']});
  // When the user selects an address from the dropdown, populate the address
  // fields in the form.
  autocomplete1.addListener('place_changed', fillInAddress);
  autocomplete2.addListener('place_changed', fillInAddress);
}

// [END region_fillform]

// [START region_geolocation]
// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
}
// [END region_geolocation]
</script>

<script>
$(document).ready(function() {
    $('#validation')
        .formValidation({
            framework: 'bootstrap',
            icon: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                number1: {
                    validators: {
                        phone: {
                            country: 'IN',
                            message: 'The value is not valid %s phone number'
                        }
                    }
                }
            }
        })
});
</script>
<body>

<script type="text/javascript">
  /* <![CDATA[ */
  goog_snippet_vars = function() {
    var w = window;
    w.google_conversion_id = 938495377;
    w.google_conversion_label = "RI-lCJ-_02IQkZvBvwM";
    w.google_conversion_value = 40.00;
    w.google_conversion_currency = "INR";
    w.google_remarketing_only = false;
  }
  // DO NOT CHANGE THE CODE BELOW.
  
/* ]]> */
</script>


<!-- Form for entering loations-->
	<div class="row">
				<div class="col-md-12">
				<div class="col-md-5"> 
				<div class="alert alert-info">
				<strong><b>How to get a precise delivery charge estimate</b>:</strong><br>
				1. Enter the first few letters of your pickup address and select the correct one from the suggestions drop down.<br>
				2. Do the same for your delivery address.<br>
				3. If your address doesn't appear in the auto complete options, select a nearest landmark which can be located on the map.<br>
				4. Enter the approximate weight of the package.<br>
				5. Click Book Now!
				</div>
				</div>

				<div class="col-md-7">
				<center><form class="form-inline" role="form">
				  <div class="form-group">
				    <input type="text" name="address1" id="address1"size="45dp" class="form-control" onFocus="geolocate()" placeholder="Pickup Address"/>
				  </div>
				  &nbsp&nbsp&nbsp&nbsp
 				  <div class="form-group">
				    <input type="text" name="address1" id="address2" size="45dp" class="form-control" onFocus="geolocate()" placeholder="Delivery Address"/>
				  </div>
				</center>	<br>
				<center><input type="number" min="1" name="weight" id="weight" size="10dp" placeholder="Weight"/></center><br>
				<center>
					<input type="button" class="btn btn-primary btn-lg" value="Book Now" id="booknow" onClick="initialize(this.id)"/>
				</center>
				</form>
				</div>
				</div>
	</div>
				<div class="row">
				<center><div style="width:100%; height:10%" id="deliverycharge"></div></center><br>
				</div>
							<style type="text/css">
								 #map-container1 { height: 610px }
							    </style>
</div>
<!-- Form for entering loations END-->
<script>
//To validate email address
function validateForm() {
    var x = document.forms["myForm"]["email1"].value;
    var atpos = x.indexOf("@");
    var dotpos = x.lastIndexOf(".");
    if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length) {
        alert("Not a valid e-mail address");
        return false;
    }
}
</script>

<script>
//Send address1, address2 and weight in the php script
function setValue(){
    document.myForm.address1.value = address1;
	document.myForm.address2.value = address2;
	document.myForm.weight_ceil.value = weight_ceil;
	var cost = $("input[name=mode1]:checked").val();
	
	if(cost==="Signature")
	document.myForm.delivery_charge.value = delivery_charge1;

	else if(cost==="Express")
	document.myForm.delivery_charge.value = delivery_charge2;
	
    goog_snippet_vars();
    window.google_conversion_format = "3";
    window.google_is_call = true;
    var opt = new Object();
    opt.onload_callback = function() {
    if (typeof(url) != 'undefined') {
      window.location = url;
    }
  }
  var conv_handler = window['google_trackConversion'];
  if (typeof(conv_handler) == 'function') {
    conv_handler(opt);
  }

	
    //document.getElementById("myForm").submit();
}
</script>
<script type="text/javascript"
	src="//www.googleadservices.com/pagead/conversion_async.js">
</script>
			<!-- Form for Booking-->
			<div class="container">
			<div class="row">
			<div id="address12" class="col-md-12" style="display:none;">
			<div class="col-md-4" >
			<form name="myForm" id="myForm" method="post">
				<div class="ajax-hidden">

				  <div class="form-group">
				  <label class="sr-only" for="name1">Name</label>
				    <input type="text" name="name1" id="name1" size="40dp" maxlength="25" class="form-control" required="true"  placeholder="Name"/>
				  </div>
				  
				   <div class="form-group">
				   <label class="sr-only" for="number1">Contact Number</label>
				    <input type="text" name="number1" id="number1" size="40dp" class="form-control" pattern="[0-9]{10}" required title="Enter a valid 10 digit number" placeholder="Contact Number"/>
				  </div>
				   <div class="form-group">
				    <label class="sr-only" for="email1">Email</label>
					<input type="email" id="email1" class="form-control" maxlength="30" name="email1" placeholder="E-mail">
				  </div>
				  
				  <div class="form-group">
				    <label class="sr-only" for="type1">Type</label>
					<input type="text" id="type1" class="form-control" maxlength="30" name="type1" placeholder="Type of goods">
				  </div>
				  
				  <div class="form-group">
					<textarea id="special1" class="form-control" name="special1" rows="3" maxlength="60" placeholder="Special Delivery Instructions:&#10;e.g: Acknowledgement back, Take cash on delivery, delivery charge paid at destination, etc."></textarea>
				  </div>
				  
				  <input type="radio" name="mode1" value="Signature" checked>Signature&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="mode1" value="Express">Express<br><br>
				  <div class="g-recaptcha" data-sitekey="6Lf1XxMTAAAAAEVris2qlfmdIPw7ZXkWSzkYO32P"></div>
				  
				  <input type="hidden" name="address1" id="address1" value="">
				  <input type="hidden" name="address2" id="address2" value="">
				  <input type="hidden" name="weight_ceil" id="weight_ceil" value="">
				  <input type="hidden" name="delivery_charge" id="delivery_charge" value="">
				  
				  <font size="1px">By clicking on Confirm Now, you agree to our <a  style="cursor: pointer;" data-toggle="modal" data-target="#myModal">Terms & Conditions</font></a>.<br>
				  <button class="btn btn-lg btn-block wow fadeInUp" data-wow-delay=".3s" onClick="setValue();" type="submit" name="submit_book" >Confirm Now</button>
				</div>
						<div class="ajax-response"></div>
			</form>
			<br>
			<div class="alert alert-info">
			Need a bulk or customized delivery or just prefer old school? You can also call or Whatsapp us on <b><font color="red"> +91-9108905901</font><b> to book a delivery.
			</div>
			</div>
			
			
			<div id="map-container1" class="col-md-8" style="display:block;"></div>
			</div>
	
			
			
			<?php if($check_submission==1){ 
				echo "<center><div class=\"alert alert-success\"><strong>Booking Confirmed</strong>. We will get back to you in 30 minutes.</div></center> ";
				echo "<script>window.alert(\"Booking Confirmed.\");</script>";
			}
			?>
			</div>
			</div>
			<!-- Form for Booking END-->
			
			
			<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Terms & Conditions</h4>
      </div>
      <div class="modal-body">
        <p><b>1.</b> Nature, contents, conditions and value of the Consignments are unknown to Simply Delivered, (hereinafter called the Company). The company carries the goods in as-it-is condition as packed by consignor and entirely at the owner's risk.</p>
		<p><b>2.</b> The Company shall not be liable for any loss or damage due to pilferage, leakage, shortage, breakage, theft, weather conditions, strikes, riots, disturbances, fire, explosions, accidents or due to any circumstances beyond control.</p>
		<p><b>3.</b> The Consignor/Consignee shall be responsible for any delay, detention, loss, deterrence, seizure, confiscation or forfeiture of goods by Government authorities: -i) If he makes a wrong declaration about the contents or ii) If transport of such goods by road is prohibited or iii) If such goods are not accompanied by invoice, permits or other proper documents and are detained by any statutory authorities. Expenses incurred if any by the company in this connection shall be borne by the Consignor/Consignee only.</p>
		<p><b>4.</b> The Consignor will have to deal directly with Octroi, Customs and any other statutory authorities for wrong declaration etc. at the destination of the goods.</p>
		<p><b>5.</b> Fresh fruits, furniture, crockery, glassware and other such delicate goods are booked at the absolute risk of the consignor and the company shall not be responsible for any perish, damage, etc.</p>
		<p><b>6.</b> The Company will not carry explosive/prohibited drugs/Gold/Silver/Bullion Coin/Industrial Diamond, Currency (Paper or Coin) of any Nationality, Lottery Ticket, Contraband items etc.</p>
		<p><b>7.</b> The goods will be delivered to the consignee’s address as mentioned by the consignor while receiving the goods.</p>
		<p><b>8.</b> In case of any dispute, the courts at Bengaluru alone will have exclusive jurisdiction.</p>
		<p><b>9.</b> The company reserves the right to refuse or accept goods for dispatch without assigning any reason.</p>
		<p><b>10.</b>  I/We declare the goods tendered by me do not contain any contraband goods and the description of the goods tendered by me/us is correct. I/We have read the above terms and conditions. I/We shall abide by the same.</p>
	  </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
<script src="assets/js/jquery-1.7.1.min.js"></script>  
<script src="assets/js/jquery.validate.js"></script> 

<script src="assets/script.js"></script> 
<script>
            addEventListener('load', prettyPrint, false);
            $(document).ready(function(){
            $('pre').addClass('prettyprint linenums');
                  });
            </script> 
</body>
</html>